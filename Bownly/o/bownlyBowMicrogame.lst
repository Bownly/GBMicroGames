                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ANSI-C Compiler
                                      3 ; Version 4.1.6 #12539 (MINGW32)
                                      4 ;--------------------------------------------------------
                                      5 	.module bownlyBowMicrogame
                                      6 	.optsdcc -mgbz80
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _bownlyBowMicrogameMain
                                     12 	.globl _playMoveSfx
                                     13 	.globl _playCollisionSfx
                                     14 	.globl _playSong
                                     15 	.globl _fadein
                                     16 	.globl _getRandUint8
                                     17 	.globl _init_bkg
                                     18 	.globl _set_sprite_data
                                     19 	.globl _set_bkg_tile_xy
                                     20 	.globl _set_bkg_data
                                     21 	.globl _joypad
                                     22 ;--------------------------------------------------------
                                     23 ; special function registers
                                     24 ;--------------------------------------------------------
                                     25 ;--------------------------------------------------------
                                     26 ; ram data
                                     27 ;--------------------------------------------------------
                                     28 	.area _DATA
      000000                         29 _bowX:
      000000                         30 	.ds 1
      000001                         31 _bowY:
      000001                         32 	.ds 1
      000002                         33 _arrowX:
      000002                         34 	.ds 1
      000003                         35 _arrowY:
      000003                         36 	.ds 1
      000004                         37 _targetX:
      000004                         38 	.ds 1
      000005                         39 _targetY:
      000005                         40 	.ds 1
      000006                         41 _bowSpeed:
      000006                         42 	.ds 1
      000007                         43 _arrowSpeed:
      000007                         44 	.ds 1
      000008                         45 _targetSpeed:
      000008                         46 	.ds 1
      000009                         47 _targetsLeft:
      000009                         48 	.ds 1
      00000A                         49 _bowFrame:
      00000A                         50 	.ds 1
      00000B                         51 _arrowState:
      00000B                         52 	.ds 1
                                     53 ;--------------------------------------------------------
                                     54 ; ram data
                                     55 ;--------------------------------------------------------
                                     56 	.area _INITIALIZED
                                     57 ;--------------------------------------------------------
                                     58 ; absolute external ram data
                                     59 ;--------------------------------------------------------
                                     60 	.area _DABS (ABS)
                                     61 ;--------------------------------------------------------
                                     62 ; global & static initialisations
                                     63 ;--------------------------------------------------------
                                     64 	.area _HOME
                                     65 	.area _GSINIT
                                     66 	.area _GSFINAL
                                     67 	.area _GSINIT
                                     68 ;--------------------------------------------------------
                                     69 ; Home
                                     70 ;--------------------------------------------------------
                                     71 	.area _HOME
                                     72 	.area _HOME
                                     73 ;--------------------------------------------------------
                                     74 ; code
                                     75 ;--------------------------------------------------------
                                     76 	.area _CODE_2
                                     77 ;Bownly/states/bownlyBowMicrogame.c:74: void bownlyBowMicrogameMain()
                                     78 ;	---------------------------------
                                     79 ; Function bownlyBowMicrogameMain
                                     80 ; ---------------------------------
      000000                         81 _bownlyBowMicrogameMain::
                                     82 ;Bownly/states/bownlyBowMicrogame.c:76: curJoypad = joypad();
      000000 CDr00r00                83 	call	_joypad
      000003 21r00r00                84 	ld	hl, #_curJoypad
      000006 73                      85 	ld	(hl), e
                                     86 ;Bownly/states/bownlyBowMicrogame.c:78: switch (substate)
      000007 FAr00r00                87 	ld	a, (#_substate)
      00000A B7                      88 	or	a, a
      00000B 28 08                   89 	jr	Z, 00101$
      00000D FAr00r00                90 	ld	a, (#_substate)
      000010 3D                      91 	dec	a
      000011 28 07                   92 	jr	Z, 00102$
      000013 18 0A                   93 	jr	00103$
                                     94 ;Bownly/states/bownlyBowMicrogame.c:80: case SUB_INIT:
      000015                         95 00101$:
                                     96 ;Bownly/states/bownlyBowMicrogame.c:81: phaseBowInit();
      000015 CDr30r00                97 	call	_phaseBowInit
                                     98 ;Bownly/states/bownlyBowMicrogame.c:82: break;
      000018 18 0F                   99 	jr	00104$
                                    100 ;Bownly/states/bownlyBowMicrogame.c:83: case SUB_LOOP:
      00001A                        101 00102$:
                                    102 ;Bownly/states/bownlyBowMicrogame.c:84: phaseBowLoop();
      00001A CDr7Dr01               103 	call	_phaseBowLoop
                                    104 ;Bownly/states/bownlyBowMicrogame.c:85: break;
      00001D 18 0A                  105 	jr	00104$
                                    106 ;Bownly/states/bownlyBowMicrogame.c:86: default:  // Abort to title in the event of unexpected state
      00001F                        107 00103$:
                                    108 ;Bownly/states/bownlyBowMicrogame.c:87: gamestate = STATE_TITLE;
      00001F 21r00r00               109 	ld	hl, #_gamestate
      000022 36 00                  110 	ld	(hl), #0x00
                                    111 ;Bownly/states/bownlyBowMicrogame.c:88: substate = SUB_INIT;
      000024 21r00r00               112 	ld	hl, #_substate
      000027 36 00                  113 	ld	(hl), #0x00
                                    114 ;Bownly/states/bownlyBowMicrogame.c:90: }
      000029                        115 00104$:
                                    116 ;Bownly/states/bownlyBowMicrogame.c:91: prevJoypad = curJoypad;
      000029 FAr00r00               117 	ld	a, (#_curJoypad)
      00002C EAr00r00               118 	ld	(#_prevJoypad),a
                                    119 ;Bownly/states/bownlyBowMicrogame.c:92: }
      00002F C9                     120 	ret
                                    121 ;Bownly/states/bownlyBowMicrogame.c:96: static void phaseBowInit()
                                    122 ;	---------------------------------
                                    123 ; Function phaseBowInit
                                    124 ; ---------------------------------
      000030                        125 _phaseBowInit:
                                    126 ;Bownly/states/bownlyBowMicrogame.c:99: init_bkg(0xFFU);
      000030 3E FF                  127 	ld	a, #0xff
      000032 F5                     128 	push	af
      000033 33                     129 	inc	sp
      000034 CDr00r00               130 	call	_init_bkg
      000037 33                     131 	inc	sp
                                    132 ;Bownly/states/bownlyBowMicrogame.c:100: animTick = 0U;
      000038 21r00r00               133 	ld	hl, #_animTick
      00003B 36 00                  134 	ld	(hl), #0x00
                                    135 ;Bownly/states/bownlyBowMicrogame.c:102: bowX = 150U;
      00003D 21r00r00               136 	ld	hl, #_bowX
      000040 36 96                  137 	ld	(hl), #0x96
                                    138 ;Bownly/states/bownlyBowMicrogame.c:103: bowY = 50U;
      000042 21r01r00               139 	ld	hl, #_bowY
      000045 36 32                  140 	ld	(hl), #0x32
                                    141 ;Bownly/states/bownlyBowMicrogame.c:104: arrowX = 150U;
      000047 21r02r00               142 	ld	hl, #_arrowX
      00004A 36 96                  143 	ld	(hl), #0x96
                                    144 ;Bownly/states/bownlyBowMicrogame.c:105: arrowY = 49U;
      00004C 21r03r00               145 	ld	hl, #_arrowY
      00004F 36 31                  146 	ld	(hl), #0x31
                                    147 ;Bownly/states/bownlyBowMicrogame.c:106: targetX = 24U;
      000051 21r04r00               148 	ld	hl, #_targetX
      000054 36 18                  149 	ld	(hl), #0x18
                                    150 ;Bownly/states/bownlyBowMicrogame.c:107: targetY = 80U;
      000056 21r05r00               151 	ld	hl, #_targetY
      000059 36 50                  152 	ld	(hl), #0x50
                                    153 ;Bownly/states/bownlyBowMicrogame.c:108: bowSpeed = 2U + mgSpeed;
      00005B FAr00r00               154 	ld	a, (#_mgSpeed)
      00005E C6 02                  155 	add	a, #0x02
      000060 EAr06r00               156 	ld	(#_bowSpeed),a
                                    157 ;Bownly/states/bownlyBowMicrogame.c:109: arrowSpeed = 4U + mgSpeed;
      000063 FAr00r00               158 	ld	a, (#_mgSpeed)
      000066 C6 04                  159 	add	a, #0x04
      000068 EAr07r00               160 	ld	(#_arrowSpeed),a
                                    161 ;Bownly/states/bownlyBowMicrogame.c:110: targetSpeed = -1;
      00006B 21r08r00               162 	ld	hl, #_targetSpeed
      00006E 36 FF                  163 	ld	(hl), #0xff
                                    164 ;Bownly/states/bownlyBowMicrogame.c:111: targetsLeft = 1U;
      000070 21r09r00               165 	ld	hl, #_targetsLeft
      000073 36 01                  166 	ld	(hl), #0x01
                                    167 ;Bownly/states/bownlyBowMicrogame.c:112: bowFrame = 1U;
      000075 21r0Ar00               168 	ld	hl, #_bowFrame
      000078 36 01                  169 	ld	(hl), #0x01
                                    170 ;Bownly/states/bownlyBowMicrogame.c:113: arrowState = NOCKED;
      00007A 21r0Br00               171 	ld	hl, #_arrowState
      00007D 36 00                  172 	ld	(hl), #0x00
                                    173 ;Bownly/states/bownlyBowMicrogame.c:116: set_bkg_data(BKGTILE_GRASS, 6U, bownlyBowBkgTiles);
      00007F 11r00r00               174 	ld	de, #_bownlyBowBkgTiles
      000082 D5                     175 	push	de
      000083 21 60 06               176 	ld	hl, #0x660
      000086 E5                     177 	push	hl
      000087 CDr00r00               178 	call	_set_bkg_data
      00008A E8 04                  179 	add	sp, #4
                                    180 ;Bownly/states/bownlyBowMicrogame.c:117: for (i = 0U; i != 20U; ++i)
      00008C 21r00r00               181 	ld	hl, #_i
      00008F 36 00                  182 	ld	(hl), #0x00
      000091                        183 00108$:
                                    184 ;Bownly/states/bownlyBowMicrogame.c:119: set_bkg_tile_xy(i, 16U, BKGTILE_GRASS);
      000091 21 10 60               185 	ld	hl, #0x6010
      000094 E5                     186 	push	hl
      000095 FAr00r00               187 	ld	a, (#_i)
      000098 F5                     188 	push	af
      000099 33                     189 	inc	sp
      00009A CDr00r00               190 	call	_set_bkg_tile_xy
      00009D E8 03                  191 	add	sp, #3
                                    192 ;Bownly/states/bownlyBowMicrogame.c:120: set_bkg_tile_xy(i, 17U, BKGTILE_GRASS + 1U);
      00009F 21 11 61               193 	ld	hl, #0x6111
      0000A2 E5                     194 	push	hl
      0000A3 FAr00r00               195 	ld	a, (#_i)
      0000A6 F5                     196 	push	af
      0000A7 33                     197 	inc	sp
      0000A8 CDr00r00               198 	call	_set_bkg_tile_xy
      0000AB E8 03                  199 	add	sp, #3
                                    200 ;Bownly/states/bownlyBowMicrogame.c:117: for (i = 0U; i != 20U; ++i)
      0000AD 21r00r00               201 	ld	hl, #_i
      0000B0 34                     202 	inc	(hl)
      0000B1 7E                     203 	ld	a, (hl)
      0000B2 D6 14                  204 	sub	a, #0x14
      0000B4 20 DB                  205 	jr	NZ, 00108$
                                    206 ;Bownly/states/bownlyBowMicrogame.c:124: set_sprite_data(SPRTILE_BOW, bownlySprBow_TILE_COUNT, bownlySprBow_tiles);
      0000B6 11r00r00               207 	ld	de, #_bownlySprBow_tiles
      0000B9 D5                     208 	push	de
      0000BA 21 00 0E               209 	ld	hl, #0xe00
      0000BD E5                     210 	push	hl
      0000BE CDr00r00               211 	call	_set_sprite_data
      0000C1 E8 04                  212 	add	sp, #4
                                    213 ;Bownly/states/bownlyBowMicrogame.c:125: set_sprite_data(SPRTILE_ARROW, bownlySprArrow_TILE_COUNT, bownlySprArrow_tiles);
      0000C3 11r00r00               214 	ld	de, #_bownlySprArrow_tiles
      0000C6 D5                     215 	push	de
      0000C7 21 0E 03               216 	ld	hl, #0x30e
      0000CA E5                     217 	push	hl
      0000CB CDr00r00               218 	call	_set_sprite_data
      0000CE E8 04                  219 	add	sp, #4
                                    220 ;Bownly/states/bownlyBowMicrogame.c:126: set_sprite_data(SPRTILE_TARGET, bownlySprTarget_TILE_COUNT, bownlySprTarget_tiles);
      0000D0 11r00r00               221 	ld	de, #_bownlySprTarget_tiles
      0000D3 D5                     222 	push	de
      0000D4 21 11 06               223 	ld	hl, #0x611
      0000D7 E5                     224 	push	hl
      0000D8 CDr00r00               225 	call	_set_sprite_data
      0000DB E8 04                  226 	add	sp, #4
                                    227 ;Bownly/states/bownlyBowMicrogame.c:128: spawnTarget();
      0000DD CDrB4r03               228 	call	_spawnTarget
                                    229 ;Bownly/states/bownlyBowMicrogame.c:129: move_metasprite(bownlySprBow_metasprites[bowFrame], SPRTILE_BOW, SPRID_BOW, bowX, bowY);
      0000E0 21r01r00               230 	ld	hl, #_bowY
      0000E3 46                     231 	ld	b, (hl)
      0000E4 21r00r00               232 	ld	hl, #_bowX
      0000E7 4E                     233 	ld	c, (hl)
      0000E8 11r00r00               234 	ld	de, #_bownlySprBow_metasprites+0
      0000EB 21r0Ar00               235 	ld	hl, #_bowFrame
      0000EE 6E                     236 	ld	l, (hl)
                                    237 ;	spillPairReg hl
                                    238 ;	spillPairReg hl
      0000EF 26 00                  239 	ld	h, #0x00
                                    240 ;	spillPairReg hl
                                    241 ;	spillPairReg hl
      0000F1 29                     242 	add	hl, hl
      0000F2 19                     243 	add	hl, de
      0000F3 2A                     244 	ld	a, (hl+)
      0000F4 6E                     245 	ld	l, (hl)
                                    246 ;	spillPairReg hl
                                    247 ;C:/gbdk/include/gb/metasprites.h:138: __current_metasprite = metasprite;
      0000F5 5F                     248 	ld	e, a
      0000F6 55                     249 	ld	d, l
      0000F7 21r00r00               250 	ld	hl, #___current_metasprite
      0000FA 7B                     251 	ld	a, e
      0000FB 22                     252 	ld	(hl+), a
      0000FC 72                     253 	ld	(hl), d
                                    254 ;C:/gbdk/include/gb/metasprites.h:139: __current_base_tile = base_tile;
      0000FD 21r00r00               255 	ld	hl, #___current_base_tile
      000100 36 00                  256 	ld	(hl), #0x00
                                    257 ;C:/gbdk/include/gb/metasprites.h:140: return __move_metasprite(base_sprite, x, y);
      000102 C5                     258 	push	bc
      000103 33                     259 	inc	sp
      000104 61                     260 	ld	h, c
      000105 2E 00                  261 	ld	l, #0x00
      000107 E5                     262 	push	hl
      000108 CDr00r00               263 	call	___move_metasprite
      00010B E8 03                  264 	add	sp, #3
                                    265 ;Bownly/states/bownlyBowMicrogame.c:130: move_metasprite(bownlySprArrow_metasprites[0U], SPRTILE_BOW + bownlySprBow_TILE_COUNT, SPRID_ARROW, arrowX, arrowY);
      00010D 21r03r00               266 	ld	hl, #_arrowY
      000110 46                     267 	ld	b, (hl)
      000111 21r02r00               268 	ld	hl, #_arrowX
      000114 4E                     269 	ld	c, (hl)
      000115 21r01r00               270 	ld	hl, #_bownlySprArrow_metasprites + 1
      000118 3A                     271 	ld	a,	(hl-)
                                    272 ;	spillPairReg hl
                                    273 ;C:/gbdk/include/gb/metasprites.h:138: __current_metasprite = metasprite;
      000119 5E                     274 	ld	e, (hl)
      00011A 57                     275 	ld	d, a
      00011B 21r00r00               276 	ld	hl, #___current_metasprite
      00011E 7B                     277 	ld	a, e
      00011F 22                     278 	ld	(hl+), a
      000120 72                     279 	ld	(hl), d
                                    280 ;C:/gbdk/include/gb/metasprites.h:139: __current_base_tile = base_tile;
      000121 21r00r00               281 	ld	hl, #___current_base_tile
      000124 36 0E                  282 	ld	(hl), #0x0e
                                    283 ;C:/gbdk/include/gb/metasprites.h:140: return __move_metasprite(base_sprite, x, y);
      000126 C5                     284 	push	bc
      000127 33                     285 	inc	sp
      000128 61                     286 	ld	h, c
      000129 2E 0A                  287 	ld	l, #0x0a
      00012B E5                     288 	push	hl
      00012C CDr00r00               289 	call	___move_metasprite
      00012F E8 03                  290 	add	sp, #3
                                    291 ;Bownly/states/bownlyBowMicrogame.c:131: move_metasprite(bownlySprTarget_metasprites[0U], SPRTILE_TARGET, SPRID_TARGET, targetX, targetY);
      000131 21r05r00               292 	ld	hl, #_targetY
      000134 46                     293 	ld	b, (hl)
      000135 21r04r00               294 	ld	hl, #_targetX
      000138 4E                     295 	ld	c, (hl)
      000139 21r01r00               296 	ld	hl, #_bownlySprTarget_metasprites + 1
      00013C 3A                     297 	ld	a,	(hl-)
                                    298 ;	spillPairReg hl
                                    299 ;C:/gbdk/include/gb/metasprites.h:138: __current_metasprite = metasprite;
      00013D 5E                     300 	ld	e, (hl)
      00013E 57                     301 	ld	d, a
      00013F 21r00r00               302 	ld	hl, #___current_metasprite
      000142 7B                     303 	ld	a, e
      000143 22                     304 	ld	(hl+), a
      000144 72                     305 	ld	(hl), d
                                    306 ;C:/gbdk/include/gb/metasprites.h:139: __current_base_tile = base_tile;
      000145 21r00r00               307 	ld	hl, #___current_base_tile
      000148 36 11                  308 	ld	(hl), #0x11
                                    309 ;C:/gbdk/include/gb/metasprites.h:140: return __move_metasprite(base_sprite, x, y);
      00014A C5                     310 	push	bc
      00014B 33                     311 	inc	sp
      00014C 61                     312 	ld	h, c
      00014D 2E 0F                  313 	ld	l, #0x0f
      00014F E5                     314 	push	hl
      000150 CDr00r00               315 	call	___move_metasprite
      000153 E8 03                  316 	add	sp, #3
                                    317 ;Bownly/states/bownlyBowMicrogame.c:134: if (mgDifficulty == 2U)
      000155 FAr00r00               318 	ld	a, (#_mgDifficulty)
      000158 D6 02                  319 	sub	a, #0x02
      00015A 20 07                  320 	jr	NZ, 00103$
                                    321 ;Bownly/states/bownlyBowMicrogame.c:135: targetsLeft = 2U;
      00015C 21r09r00               322 	ld	hl, #_targetsLeft
      00015F 36 02                  323 	ld	(hl), #0x02
      000161 18 05                  324 	jr	00104$
      000163                        325 00103$:
                                    326 ;Bownly/states/bownlyBowMicrogame.c:137: targetsLeft = 1U;
      000163 21r09r00               327 	ld	hl, #_targetsLeft
      000166 36 01                  328 	ld	(hl), #0x01
      000168                        329 00104$:
                                    330 ;Bownly/states/bownlyBowMicrogame.c:139: substate = SUB_LOOP;
      000168 21r00r00               331 	ld	hl, #_substate
      00016B 36 01                  332 	ld	(hl), #0x01
                                    333 ;Bownly/states/bownlyBowMicrogame.c:141: playSong(&bownlyTheWhite2Song);
      00016D 11r00r00               334 	ld	de, #_bownlyTheWhite2Song
      000170 D5                     335 	push	de
      000171 CDr00r00               336 	call	_playSong
      000174 E1                     337 	pop	hl
                                    338 ;Bownly/states/bownlyBowMicrogame.c:143: fadein();
      000175 CDr00r00               339 	call	_fadein
                                    340 ;Bownly/states/bownlyBowMicrogame.c:145: OBP0_REG = 0xE4;  // 11 10 01 00
      000178 3E E4                  341 	ld	a, #0xe4
      00017A E0r00                  342 	ldh	(_OBP0_REG + 0), a
                                    343 ;Bownly/states/bownlyBowMicrogame.c:146: }
      00017C C9                     344 	ret
                                    345 ;Bownly/states/bownlyBowMicrogame.c:148: static void phaseBowLoop()
                                    346 ;	---------------------------------
                                    347 ; Function phaseBowLoop
                                    348 ; ---------------------------------
      00017D                        349 _phaseBowLoop:
      00017D E8 FA                  350 	add	sp, #-6
                                    351 ;Bownly/states/bownlyBowMicrogame.c:150: ++animTick;
      00017F 21r00r00               352 	ld	hl, #_animTick
      000182 34                     353 	inc	(hl)
                                    354 ;Bownly/states/bownlyBowMicrogame.c:151: if (bowY >= 130U || bowY <= 40U)
      000183 21r01r00               355 	ld	hl, #_bowY
      000186 7E                     356 	ld	a, (hl)
      000187 D6 82                  357 	sub	a, #0x82
      000189 30 05                  358 	jr	NC, 00101$
      00018B 3E 28                  359 	ld	a, #0x28
      00018D 96                     360 	sub	a, (hl)
      00018E 38 06                  361 	jr	C, 00102$
      000190                        362 00101$:
                                    363 ;Bownly/states/bownlyBowMicrogame.c:152: bowSpeed *= -1;
      000190 AF                     364 	xor	a, a
      000191 21r06r00               365 	ld	hl, #_bowSpeed
      000194 96                     366 	sub	a, (hl)
      000195 77                     367 	ld	(hl), a
      000196                        368 00102$:
                                    369 ;Bownly/states/bownlyBowMicrogame.c:153: bowY += bowSpeed;
      000196 FAr01r00               370 	ld	a, (#_bowY)
      000199 21r06r00               371 	ld	hl, #_bowSpeed
      00019C 86                     372 	add	a, (hl)
      00019D EAr01r00               373 	ld	(#_bowY),a
                                    374 ;Bownly/states/bownlyBowMicrogame.c:155: switch (arrowState)
      0001A0 FAr0Br00               375 	ld	a, (#_arrowState)
      0001A3 B7                     376 	or	a, a
      0001A4 28 21                  377 	jr	Z, 00104$
                                    378 ;Bownly/states/bownlyBowMicrogame.c:192: else if (arrowX >= 200U)
      0001A6 21r02r00               379 	ld	hl, #_arrowX
      0001A9 7E                     380 	ld	a, (hl)
      0001AA D6 C8                  381 	sub	a, #0xc8
      0001AC 3E 00                  382 	ld	a, #0x00
      0001AE 17                     383 	rla
      0001AF 4F                     384 	ld	c, a
                                    385 ;Bownly/states/bownlyBowMicrogame.c:200: arrowX -= arrowSpeed;
      0001B0 7E                     386 	ld	a, (hl)
      0001B1 21r07r00               387 	ld	hl, #_arrowSpeed
      0001B4 96                     388 	sub	a, (hl)
      0001B5 47                     389 	ld	b, a
                                    390 ;Bownly/states/bownlyBowMicrogame.c:155: switch (arrowState)
      0001B6 FAr0Br00               391 	ld	a, (#_arrowState)
      0001B9 3D                     392 	dec	a
      0001BA 28 3E                  393 	jr	Z, 00110$
      0001BC FAr0Br00               394 	ld	a, (#_arrowState)
      0001BF D6 02                  395 	sub	a, #0x02
      0001C1 CAr7Br02               396 	jp	Z,00126$
      0001C4 C3rC4r02               397 	jp	00133$
                                    398 ;Bownly/states/bownlyBowMicrogame.c:157: case NOCKED:
      0001C7                        399 00104$:
                                    400 ;Bownly/states/bownlyBowMicrogame.c:158: inputsShoot();
      0001C7 CDr9Ar03               401 	call	_inputsShoot
                                    402 ;Bownly/states/bownlyBowMicrogame.c:160: if (mgDifficulty != 0U)
      0001CA FAr00r00               403 	ld	a, (#_mgDifficulty)
      0001CD B7                     404 	or	a, a
      0001CE 28 1D                  405 	jr	Z, 00109$
                                    406 ;Bownly/states/bownlyBowMicrogame.c:163: if (targetY >= 130U || targetY <= 40U)
      0001D0 21r05r00               407 	ld	hl, #_targetY
      0001D3 7E                     408 	ld	a, (hl)
      0001D4 D6 82                  409 	sub	a, #0x82
      0001D6 30 05                  410 	jr	NC, 00105$
      0001D8 3E 28                  411 	ld	a, #0x28
      0001DA 96                     412 	sub	a, (hl)
      0001DB 38 06                  413 	jr	C, 00106$
      0001DD                        414 00105$:
                                    415 ;Bownly/states/bownlyBowMicrogame.c:164: targetSpeed *= -1;
      0001DD AF                     416 	xor	a, a
      0001DE 21r08r00               417 	ld	hl, #_targetSpeed
      0001E1 96                     418 	sub	a, (hl)
      0001E2 77                     419 	ld	(hl), a
      0001E3                        420 00106$:
                                    421 ;Bownly/states/bownlyBowMicrogame.c:165: targetY += targetSpeed;
      0001E3 FAr05r00               422 	ld	a, (#_targetY)
      0001E6 21r08r00               423 	ld	hl, #_targetSpeed
      0001E9 86                     424 	add	a, (hl)
      0001EA EAr05r00               425 	ld	(#_targetY),a
      0001ED                        426 00109$:
                                    427 ;Bownly/states/bownlyBowMicrogame.c:168: arrowY += bowSpeed;
      0001ED FAr03r00               428 	ld	a, (#_arrowY)
      0001F0 21r06r00               429 	ld	hl, #_bowSpeed
      0001F3 86                     430 	add	a, (hl)
      0001F4 EAr03r00               431 	ld	(#_arrowY),a
                                    432 ;Bownly/states/bownlyBowMicrogame.c:169: break;
      0001F7 C3rC4r02               433 	jp	00133$
                                    434 ;Bownly/states/bownlyBowMicrogame.c:170: case FLYING:
      0001FA                        435 00110$:
                                    436 ;Bownly/states/bownlyBowMicrogame.c:171: if (mgDifficulty != 0U)
      0001FA FAr00r00               437 	ld	a, (#_mgDifficulty)
      0001FD B7                     438 	or	a, a
      0001FE 28 1D                  439 	jr	Z, 00115$
                                    440 ;Bownly/states/bownlyBowMicrogame.c:174: if (targetY >= 130U || targetY <= 40U)
      000200 21r05r00               441 	ld	hl, #_targetY
      000203 7E                     442 	ld	a, (hl)
      000204 D6 82                  443 	sub	a, #0x82
      000206 30 05                  444 	jr	NC, 00111$
      000208 3E 28                  445 	ld	a, #0x28
      00020A 96                     446 	sub	a, (hl)
      00020B 38 06                  447 	jr	C, 00112$
      00020D                        448 00111$:
                                    449 ;Bownly/states/bownlyBowMicrogame.c:175: targetSpeed *= -1;
      00020D AF                     450 	xor	a, a
      00020E 21r08r00               451 	ld	hl, #_targetSpeed
      000211 96                     452 	sub	a, (hl)
      000212 77                     453 	ld	(hl), a
      000213                        454 00112$:
                                    455 ;Bownly/states/bownlyBowMicrogame.c:176: targetY += targetSpeed;
      000213 FAr05r00               456 	ld	a, (#_targetY)
      000216 21r08r00               457 	ld	hl, #_targetSpeed
      000219 86                     458 	add	a, (hl)
      00021A EAr05r00               459 	ld	(#_targetY),a
      00021D                        460 00115$:
                                    461 ;Bownly/states/bownlyBowMicrogame.c:179: if (arrowX == 30U)
      00021D FAr02r00               462 	ld	a, (#_arrowX)
      000220 D6 1E                  463 	sub	a, #0x1e
      000222 20 35                  464 	jr	NZ, 00124$
                                    465 ;Bownly/states/bownlyBowMicrogame.c:181: if (arrowY <= targetY + 15U && arrowY >= targetY - 15U)
      000224 21r05r00               466 	ld	hl, #_targetY
      000227 4E                     467 	ld	c, (hl)
      000228 06 00                  468 	ld	b, #0x00
      00022A 21 0F 00               469 	ld	hl, #0x000f
      00022D 09                     470 	add	hl, bc
      00022E 5D                     471 	ld	e, l
      00022F FAr03r00               472 	ld	a, (_arrowY)
      000232 6F                     473 	ld	l, a
                                    474 ;	spillPairReg hl
                                    475 ;	spillPairReg hl
      000233 16 00                  476 	ld	d, #0x00
      000235 7B                     477 	ld	a, e
      000236 95                     478 	sub	a, l
      000237 7C                     479 	ld	a, h
      000238 9A                     480 	sbc	a, d
      000239 38 18                  481 	jr	C, 00117$
      00023B 79                     482 	ld	a, c
      00023C C6 F1                  483 	add	a, #0xf1
      00023E 4F                     484 	ld	c, a
      00023F 78                     485 	ld	a, b
      000240 CE FF                  486 	adc	a, #0xff
      000242 47                     487 	ld	b, a
      000243 7D                     488 	ld	a, l
      000244 91                     489 	sub	a, c
      000245 7A                     490 	ld	a, d
      000246 98                     491 	sbc	a, b
      000247 38 0A                  492 	jr	C, 00117$
                                    493 ;Bownly/states/bownlyBowMicrogame.c:183: playCollisionSfx();
      000249 CDr00r00               494 	call	_playCollisionSfx
                                    495 ;Bownly/states/bownlyBowMicrogame.c:184: arrowState = HIT;
      00024C 21r0Br00               496 	ld	hl, #_arrowState
      00024F 36 02                  497 	ld	(hl), #0x02
      000251 18 71                  498 	jr	00133$
      000253                        499 00117$:
                                    500 ;Bownly/states/bownlyBowMicrogame.c:188: arrowX -= 1;
      000253 21r02r00               501 	ld	hl, #_arrowX
      000256 35                     502 	dec	(hl)
      000257 18 6B                  503 	jr	00133$
      000259                        504 00124$:
                                    505 ;Bownly/states/bownlyBowMicrogame.c:192: else if (arrowX >= 200U)
      000259 CB 41                  506 	bit	0, c
      00025B 20 18                  507 	jr	NZ, 00121$
                                    508 ;Bownly/states/bownlyBowMicrogame.c:194: arrowState = NOCKED;
      00025D 21r0Br00               509 	ld	hl, #_arrowState
      000260 36 00                  510 	ld	(hl), #0x00
                                    511 ;Bownly/states/bownlyBowMicrogame.c:195: bowFrame = 1U;
      000262 21r0Ar00               512 	ld	hl, #_bowFrame
      000265 36 01                  513 	ld	(hl), #0x01
                                    514 ;Bownly/states/bownlyBowMicrogame.c:196: arrowX = bowX;
      000267 FAr00r00               515 	ld	a, (#_bowX)
      00026A EAr02r00               516 	ld	(#_arrowX),a
                                    517 ;Bownly/states/bownlyBowMicrogame.c:197: arrowY = bowY;
      00026D FAr01r00               518 	ld	a, (#_bowY)
      000270 EAr03r00               519 	ld	(#_arrowY),a
      000273 18 4F                  520 	jr	00133$
      000275                        521 00121$:
                                    522 ;Bownly/states/bownlyBowMicrogame.c:200: arrowX -= arrowSpeed;
      000275 21r02r00               523 	ld	hl, #_arrowX
      000278 70                     524 	ld	(hl), b
                                    525 ;Bownly/states/bownlyBowMicrogame.c:201: break;
      000279 18 49                  526 	jr	00133$
                                    527 ;Bownly/states/bownlyBowMicrogame.c:202: case HIT:
      00027B                        528 00126$:
                                    529 ;Bownly/states/bownlyBowMicrogame.c:203: if (arrowX >= 200U)  // Offscreen, or close enough
      00027B CB 41                  530 	bit	0, c
      00027D 20 37                  531 	jr	NZ, 00131$
                                    532 ;Bownly/states/bownlyBowMicrogame.c:205: if (--targetsLeft == 0U)  // End game if no more targets
      00027F 21r09r00               533 	ld	hl, #_targetsLeft
      000282 35                     534 	dec	(hl)
      000283 20 16                  535 	jr	NZ, 00128$
                                    536 ;Bownly/states/bownlyBowMicrogame.c:207: mgStatus = WON;
      000285 21r00r00               537 	ld	hl, #_mgStatus
      000288 36 02                  538 	ld	(hl), #0x02
                                    539 ;Bownly/states/bownlyBowMicrogame.c:210: arrowSpeed = 0U;
      00028A 21r07r00               540 	ld	hl, #_arrowSpeed
      00028D 36 00                  541 	ld	(hl), #0x00
                                    542 ;Bownly/states/bownlyBowMicrogame.c:211: arrowX = 190U;
      00028F 21r02r00               543 	ld	hl, #_arrowX
      000292 36 BE                  544 	ld	(hl), #0xbe
                                    545 ;Bownly/states/bownlyBowMicrogame.c:212: targetX = 190U;
      000294 21r04r00               546 	ld	hl, #_targetX
      000297 36 BE                  547 	ld	(hl), #0xbe
      000299 18 29                  548 	jr	00133$
      00029B                        549 00128$:
                                    550 ;Bownly/states/bownlyBowMicrogame.c:216: spawnTarget();
      00029B CDrB4r03               551 	call	_spawnTarget
                                    552 ;Bownly/states/bownlyBowMicrogame.c:217: arrowState = NOCKED;
      00029E 21r0Br00               553 	ld	hl, #_arrowState
      0002A1 36 00                  554 	ld	(hl), #0x00
                                    555 ;Bownly/states/bownlyBowMicrogame.c:218: bowFrame = 1U;
      0002A3 21r0Ar00               556 	ld	hl, #_bowFrame
      0002A6 36 01                  557 	ld	(hl), #0x01
                                    558 ;Bownly/states/bownlyBowMicrogame.c:219: arrowX = bowX;
      0002A8 FAr00r00               559 	ld	a, (#_bowX)
      0002AB EAr02r00               560 	ld	(#_arrowX),a
                                    561 ;Bownly/states/bownlyBowMicrogame.c:220: arrowY = bowY;
      0002AE FAr01r00               562 	ld	a, (#_bowY)
      0002B1 EAr03r00               563 	ld	(#_arrowY),a
      0002B4 18 0E                  564 	jr	00133$
      0002B6                        565 00131$:
                                    566 ;Bownly/states/bownlyBowMicrogame.c:225: arrowX -= arrowSpeed;
      0002B6 21r02r00               567 	ld	hl, #_arrowX
      0002B9 70                     568 	ld	(hl), b
                                    569 ;Bownly/states/bownlyBowMicrogame.c:226: targetX -= arrowSpeed;
      0002BA FAr04r00               570 	ld	a, (#_targetX)
      0002BD 21r07r00               571 	ld	hl, #_arrowSpeed
      0002C0 96                     572 	sub	a, (hl)
      0002C1 EAr04r00               573 	ld	(#_targetX),a
                                    574 ;Bownly/states/bownlyBowMicrogame.c:229: }
      0002C4                        575 00133$:
                                    576 ;Bownly/states/bownlyBowMicrogame.c:233: move_metasprite(bownlySprBow_metasprites[bowFrame], SPRTILE_BOW, SPRID_BOW, arrowX, arrowY);
      0002C4 FAr0Ar00               577 	ld	a, (#_bowFrame)
      0002C7 0E 00                  578 	ld	c, #0x00
      0002C9 87                     579 	add	a, a
      0002CA CB 11                  580 	rl	c
      0002CC F8 00                  581 	ldhl	sp,	#0
      0002CE 22                     582 	ld	(hl+), a
      0002CF 71                     583 	ld	(hl), c
                                    584 ;Bownly/states/bownlyBowMicrogame.c:232: if (mgDifficulty == 2U && targetsLeft == 1U)
      0002D0 FAr00r00               585 	ld	a, (#_mgDifficulty)
      0002D3 D6 02                  586 	sub	a, #0x02
      0002D5 20 36                  587 	jr	NZ, 00135$
      0002D7 FAr09r00               588 	ld	a, (#_targetsLeft)
      0002DA 3D                     589 	dec	a
      0002DB 20 30                  590 	jr	NZ, 00135$
                                    591 ;Bownly/states/bownlyBowMicrogame.c:233: move_metasprite(bownlySprBow_metasprites[bowFrame], SPRTILE_BOW, SPRID_BOW, arrowX, arrowY);
      0002DD FAr03r00               592 	ld	a, (#_arrowY)
      0002E0 F8 04                  593 	ldhl	sp,	#4
      0002E2 77                     594 	ld	(hl), a
      0002E3 FAr02r00               595 	ld	a, (#_arrowX)
      0002E6 F8 05                  596 	ldhl	sp,	#5
      0002E8 77                     597 	ld	(hl), a
      0002E9 11r00r00               598 	ld	de, #_bownlySprBow_metasprites
      0002EC E1                     599 	pop	hl
      0002ED E5                     600 	push	hl
      0002EE 19                     601 	add	hl, de
      0002EF 2A                     602 	ld	a, (hl+)
      0002F0 4F                     603 	ld	c, a
      0002F1 46                     604 	ld	b, (hl)
                                    605 ;C:/gbdk/include/gb/metasprites.h:138: __current_metasprite = metasprite;
      0002F2 21r00r00               606 	ld	hl, #___current_metasprite
      0002F5 79                     607 	ld	a, c
      0002F6 22                     608 	ld	(hl+), a
      0002F7 70                     609 	ld	(hl), b
                                    610 ;C:/gbdk/include/gb/metasprites.h:139: __current_base_tile = base_tile;
      0002F8 21r00r00               611 	ld	hl, #___current_base_tile
      0002FB 36 00                  612 	ld	(hl), #0x00
                                    613 ;C:/gbdk/include/gb/metasprites.h:140: return __move_metasprite(base_sprite, x, y);
      0002FD F8 04                  614 	ldhl	sp,	#4
      0002FF 2A                     615 	ld	a, (hl+)
      000300 F5                     616 	push	af
      000301 33                     617 	inc	sp
      000302 66                     618 	ld	h, (hl)
      000303 2E 00                  619 	ld	l, #0x00
      000305 E5                     620 	push	hl
      000306 CDr00r00               621 	call	___move_metasprite
      000309 E8 03                  622 	add	sp, #3
                                    623 ;Bownly/states/bownlyBowMicrogame.c:233: move_metasprite(bownlySprBow_metasprites[bowFrame], SPRTILE_BOW, SPRID_BOW, arrowX, arrowY);
      00030B 18 42                  624 	jr	00136$
      00030D                        625 00135$:
                                    626 ;Bownly/states/bownlyBowMicrogame.c:235: move_metasprite(bownlySprBow_metasprites[bowFrame], SPRTILE_BOW, SPRID_BOW, bowX, bowY);
      00030D FAr01r00               627 	ld	a, (#_bowY)
      000310 F8 02                  628 	ldhl	sp,	#2
      000312 77                     629 	ld	(hl), a
      000313 FAr00r00               630 	ld	a, (#_bowX)
      000316 F8 03                  631 	ldhl	sp,	#3
      000318 77                     632 	ld	(hl), a
      000319 11r00r00               633 	ld	de, #_bownlySprBow_metasprites
      00031C E1                     634 	pop	hl
      00031D E5                     635 	push	hl
      00031E 19                     636 	add	hl, de
      00031F E5                     637 	push	hl
      000320 7D                     638 	ld	a, l
      000321 F8 06                  639 	ldhl	sp,	#6
      000323 77                     640 	ld	(hl), a
      000324 E1                     641 	pop	hl
      000325 7C                     642 	ld	a, h
      000326 F8 05                  643 	ldhl	sp,	#5
      000328 32                     644 	ld	(hl-), a
      000329 2A                     645 	ld	a, (hl+)
      00032A 5F                     646 	ld	e, a
      00032B 3A                     647 	ld	a, (hl-)
      00032C 57                     648 	ld	d, a
      00032D 1A                     649 	ld	a, (de)
      00032E 22                     650 	ld	(hl+), a
      00032F 13                     651 	inc	de
      000330 1A                     652 	ld	a, (de)
                                    653 ;C:/gbdk/include/gb/metasprites.h:138: __current_metasprite = metasprite;
      000331 32                     654 	ld	(hl-), a
      000332 7E                     655 	ld	a, (hl)
      000333 EAr00r00               656 	ld	(#___current_metasprite),a
      000336 F8 05                  657 	ldhl	sp,	#5
      000338 7E                     658 	ld	a, (hl)
      000339 EAr01r00               659 	ld	(#___current_metasprite + 1),a
                                    660 ;C:/gbdk/include/gb/metasprites.h:139: __current_base_tile = base_tile;
      00033C 21r00r00               661 	ld	hl, #___current_base_tile
      00033F 36 00                  662 	ld	(hl), #0x00
                                    663 ;C:/gbdk/include/gb/metasprites.h:140: return __move_metasprite(base_sprite, x, y);
      000341 F8 02                  664 	ldhl	sp,	#2
      000343 2A                     665 	ld	a, (hl+)
      000344 F5                     666 	push	af
      000345 33                     667 	inc	sp
      000346 66                     668 	ld	h, (hl)
      000347 2E 00                  669 	ld	l, #0x00
      000349 E5                     670 	push	hl
      00034A CDr00r00               671 	call	___move_metasprite
      00034D E8 03                  672 	add	sp, #3
                                    673 ;Bownly/states/bownlyBowMicrogame.c:235: move_metasprite(bownlySprBow_metasprites[bowFrame], SPRTILE_BOW, SPRID_BOW, bowX, bowY);
      00034F                        674 00136$:
                                    675 ;Bownly/states/bownlyBowMicrogame.c:237: move_metasprite(bownlySprArrow_metasprites[0U], SPRTILE_ARROW, SPRID_ARROW, arrowX, arrowY);
      00034F 21r03r00               676 	ld	hl, #_arrowY
      000352 4E                     677 	ld	c, (hl)
      000353 21r02r00               678 	ld	hl, #_arrowX
      000356 46                     679 	ld	b, (hl)
      000357 21r00r00               680 	ld	hl, #_bownlySprArrow_metasprites
      00035A 2A                     681 	ld	a,	(hl+)
      00035B 66                     682 	ld	h, (hl)
                                    683 ;	spillPairReg hl
                                    684 ;	spillPairReg hl
                                    685 ;	spillPairReg hl
                                    686 ;C:/gbdk/include/gb/metasprites.h:138: __current_metasprite = metasprite;
      00035C 5F                     687 	ld	e, a
      00035D 54                     688 	ld	d, h
      00035E 21r00r00               689 	ld	hl, #___current_metasprite
      000361 7B                     690 	ld	a, e
      000362 22                     691 	ld	(hl+), a
      000363 72                     692 	ld	(hl), d
                                    693 ;C:/gbdk/include/gb/metasprites.h:139: __current_base_tile = base_tile;
      000364 21r00r00               694 	ld	hl, #___current_base_tile
      000367 36 0E                  695 	ld	(hl), #0x0e
                                    696 ;C:/gbdk/include/gb/metasprites.h:140: return __move_metasprite(base_sprite, x, y);
      000369 79                     697 	ld	a, c
      00036A F5                     698 	push	af
      00036B 33                     699 	inc	sp
      00036C 0E 0A                  700 	ld	c, #0x0a
      00036E C5                     701 	push	bc
      00036F CDr00r00               702 	call	___move_metasprite
      000372 E8 03                  703 	add	sp, #3
                                    704 ;Bownly/states/bownlyBowMicrogame.c:238: move_metasprite(bownlySprTarget_metasprites[0U], SPRTILE_TARGET, SPRID_TARGET, targetX, targetY);
      000374 21r05r00               705 	ld	hl, #_targetY
      000377 4E                     706 	ld	c, (hl)
      000378 21r04r00               707 	ld	hl, #_targetX
      00037B 46                     708 	ld	b, (hl)
      00037C 21r00r00               709 	ld	hl, #_bownlySprTarget_metasprites
      00037F 2A                     710 	ld	a,	(hl+)
      000380 66                     711 	ld	h, (hl)
                                    712 ;	spillPairReg hl
                                    713 ;	spillPairReg hl
                                    714 ;	spillPairReg hl
                                    715 ;C:/gbdk/include/gb/metasprites.h:138: __current_metasprite = metasprite;
      000381 5F                     716 	ld	e, a
      000382 54                     717 	ld	d, h
      000383 21r00r00               718 	ld	hl, #___current_metasprite
      000386 7B                     719 	ld	a, e
      000387 22                     720 	ld	(hl+), a
      000388 72                     721 	ld	(hl), d
                                    722 ;C:/gbdk/include/gb/metasprites.h:139: __current_base_tile = base_tile;
      000389 21r00r00               723 	ld	hl, #___current_base_tile
      00038C 36 11                  724 	ld	(hl), #0x11
                                    725 ;C:/gbdk/include/gb/metasprites.h:140: return __move_metasprite(base_sprite, x, y);
      00038E 79                     726 	ld	a, c
      00038F F5                     727 	push	af
      000390 33                     728 	inc	sp
      000391 0E 0F                  729 	ld	c, #0x0f
      000393 C5                     730 	push	bc
      000394 CDr00r00               731 	call	___move_metasprite
                                    732 ;Bownly/states/bownlyBowMicrogame.c:238: move_metasprite(bownlySprTarget_metasprites[0U], SPRTILE_TARGET, SPRID_TARGET, targetX, targetY);
                                    733 ;Bownly/states/bownlyBowMicrogame.c:239: }
      000397 E8 09                  734 	add	sp, #9
      000399 C9                     735 	ret
                                    736 ;Bownly/states/bownlyBowMicrogame.c:243: static void inputsShoot()
                                    737 ;	---------------------------------
                                    738 ; Function inputsShoot
                                    739 ; ---------------------------------
      00039A                        740 _inputsShoot:
                                    741 ;Bownly/states/bownlyBowMicrogame.c:245: if (curJoypad & J_A && !(prevJoypad & J_A))
      00039A FAr00r00               742 	ld	a, (#_curJoypad)
      00039D CB 67                  743 	bit	4, a
      00039F C8                     744 	ret	Z
      0003A0 FAr00r00               745 	ld	a, (#_prevJoypad)
      0003A3 CB 67                  746 	bit	4, a
      0003A5 C0                     747 	ret	NZ
                                    748 ;Bownly/states/bownlyBowMicrogame.c:247: playMoveSfx();
      0003A6 CDr00r00               749 	call	_playMoveSfx
                                    750 ;Bownly/states/bownlyBowMicrogame.c:248: arrowState = FLYING;
      0003A9 21r0Br00               751 	ld	hl, #_arrowState
      0003AC 36 01                  752 	ld	(hl), #0x01
                                    753 ;Bownly/states/bownlyBowMicrogame.c:249: bowFrame = 0U;
      0003AE 21r0Ar00               754 	ld	hl, #_bowFrame
      0003B1 36 00                  755 	ld	(hl), #0x00
                                    756 ;Bownly/states/bownlyBowMicrogame.c:251: }
      0003B3 C9                     757 	ret
                                    758 ;Bownly/states/bownlyBowMicrogame.c:255: static void spawnTarget()
                                    759 ;	---------------------------------
                                    760 ; Function spawnTarget
                                    761 ; ---------------------------------
      0003B4                        762 _spawnTarget:
                                    763 ;Bownly/states/bownlyBowMicrogame.c:257: targetX = 24U;
      0003B4 21r04r00               764 	ld	hl, #_targetX
      0003B7 36 18                  765 	ld	(hl), #0x18
                                    766 ;Bownly/states/bownlyBowMicrogame.c:258: targetY = getRandUint8(90U);  // Range of 40-130
      0003B9 3E 5A                  767 	ld	a, #0x5a
      0003BB F5                     768 	push	af
      0003BC 33                     769 	inc	sp
      0003BD CDr00r00               770 	call	_getRandUint8
      0003C0 33                     771 	inc	sp
      0003C1 21r05r00               772 	ld	hl, #_targetY
      0003C4 73                     773 	ld	(hl), e
                                    774 ;Bownly/states/bownlyBowMicrogame.c:259: targetY += 40U;
      0003C5 7E                     775 	ld	a, (hl)
      0003C6 C6 28                  776 	add	a, #0x28
      0003C8 77                     777 	ld	(hl), a
                                    778 ;Bownly/states/bownlyBowMicrogame.c:260: }
      0003C9 C9                     779 	ret
                                    780 	.area _CODE_2
                                    781 	.area _INITIALIZER
                                    782 	.area _CABS (ABS)
